# PDF转Anki转换器 - 使用说明

## 功能特点

✅ 自动识别PDF中的选择题  
✅ 支持单选题和多选题  
✅ 自动提取答案和解析  
✅ 灵活的题目选择功能  
✅ 导出为CSV或APKG格式  
✅ Anki卡片支持交互式选项  

## 快速开始

### 1. 启动程序

双击运行 `run.bat` 文件，程序会自动：
- 检查Python环境
- 安装必要的依赖包
- 启动图形界面

### 2. 加载PDF文件

1. 点击 **"选择PDF文件"** 按钮
2. 选择您的PDF文件
3. 点击 **"加载并解析PDF"** 按钮
4. 等待解析完成

### 3. 预览和筛选题目

解析完成后，您可以：
- 在左侧列表查看所有题目
- 使用筛选功能：全部/需审核/单选题/多选题
- 点击题目查看详细内容

## 序号选择功能（重点）

### 功能位置

在 **题目预览区域** 的底部，您会看到：

```
[全选] [取消全选] [切换选中]  序号选择: [输入框] [选择] (如: 1-10,15,20-25)  已选中: 0
```

### 支持的输入格式

| 格式 | 示例 | 说明 |
|------|------|------|
| 中文逗号分隔 | `1，6，9` | 选择题目1、6、9 |
| 英文逗号分隔 | `1,6,9` | 选择题目1、6、9 |
| 范围格式 | `1-10` | 选择题目1到10 |
| 混合格式 | `1-10,15,20-25` | 选择题目1-10、15、20-25 |
| 中文逗号混合 | `1-5，10，15-17` | 选择题目1-5、10、15-17 |

### 使用步骤

1. **输入序号**：在"序号选择"输入框中输入题目序号
   - 例如：`1，6，9`

2. **点击选择**：点击"选择"按钮

3. **查看结果**：
   - 题目列表中对应的题目会显示 ✓ 标记
   - 右侧显示"已选中: 3"

4. **导出选中**：
   - 在"导出范围"中选择 **"仅选中"**
   - 选择导出格式（CSV或APKG）
   - 点击"导出"按钮

## 导出功能

### CSV导出

- 格式：Anki可导入的CSV格式
- 编码：UTF-8（带BOM），Excel可正确显示中文
- 内容：题目、选项、答案

### APKG导出

- 格式：Anki卡片包
- 特点：
  - 绿色主题，护眼舒适
  - 交互式选项，可点击选择
  - **智能答案对比**：
    - 显示您的答案
    - 显示正确答案
    - 自动判断对错
    - 正确答案标记为绿色（加粗）
    - 错误选择标记为红色（加粗）
    - 显示 ✓ 或 ✗ 判断结果
  - 包含题目解析

### 导出选项

- **导出格式**：CSV 或 APKG
- **导出范围**：
  - **全部**：导出所有题目
  - **仅选中**：只导出选中的题目
- **批量模式**：
  - **合并**：所有题目合并到一个文件
  - **分离**：每个PDF生成单独的文件

## 示例：选择题目1、6、9并导出

### 方法1：使用序号选择

1. 在序号选择输入框输入：`1，6，9`
2. 点击"选择"按钮
3. 在"导出范围"选择"仅选中"
4. 点击"导出"按钮

### 方法2：手动选择

1. 在题目列表中点击题目1、6、9（按住Ctrl多选）
2. 点击"切换选中"按钮
3. 在"导出范围"选择"仅选中"
4. 点击"导出"按钮

## 答案识别说明

程序支持多种答案格式：

- `【正确答案】 A`
- `【答案】 BCE`
- `答案：D`
- `(答案：A)`
- 答案在PDF末尾单独列出

如果PDF中没有答案，题目会显示"答案：未知"，您可以手动编辑。

## 题目编辑

1. 在题目列表中选择一道题目
2. 点击"编辑题目"按钮
3. 修改题目内容、选项、答案等
4. 点击"保存"

## 常见问题

### Q: 为什么有些题目显示"需审核"？

A: 以下情况会标记为需审核：
- 没有识别到答案
- 选项少于2个
- 题目文本为空

### Q: 如何选择不连续的题目？

A: 使用序号选择功能，输入如：`1，5，10，15`

### Q: 导出的CSV在Excel中乱码怎么办？

A: 程序已使用UTF-8 BOM编码，Excel应该能正确显示。如果仍有问题，请使用记事本打开CSV文件，另存为时选择UTF-8编码。

### Q: Anki卡片如何使用？

A: 
1. 打开Anki
2. 文件 -> 导入
3. 选择导出的.apkg文件
4. 点击导入
5. 学习时：
   - 看到题目后，点击选项进行选择（选中的选项会变蓝色）
   - 点击"显示答案"
   - 系统会自动显示：
     - 您的答案（蓝色区域）
     - 正确答案（绿色区域）
     - 判断结果（✓ 正确 或 ✗ 错误）
     - 正确选项显示为绿色加粗
     - 错误选项显示为红色加粗

## 技术支持

如有问题，请查看：
- `run.bat` 运行日志
- 测试文件：`run_tests.bat`

## 更新日志

### v1.1.0 (最新)
- ✅ **新增**：智能答案对比功能
  - 显示用户答案和正确答案
  - 自动判断对错
  - 正确答案绿色标记
  - 错误答案红色标记
  - 显示判断结果（✓/✗）

### v1.0.0
- ✅ 支持PDF题目识别
- ✅ 支持CSV和APKG导出
- ✅ 序号选择功能
- ✅ 答案自动识别
- ✅ 绿色主题Anki卡片
- ✅ 中文界面
